# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'main2.ui'
#
# Created by: PyQt5 UI code generator 5.15.0
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QApplication, QWidget, QHBoxLayout, QTableWidget, QTableWidgetItem, QMessageBox
from itertools import product
import sys
import numpy as np
from PyQt5 import QtCore, QtGui, QtWidgets
from pynput.keyboard import Key, Controller
import win32process
import os
import time


class Ui_Form(QWidget):
    def __init__(self):
        super(Ui_Form, self).__init__()
        self.initial()
        self.signal()
        # 其他实例属性
        self.top = 0
        self.left = 0
        self.bottom = 0
        self.right = 0
        self.column_n = 0
        self.number = 0
        self.row_n = 0
        self.c = []
        self.clipboard = QApplication.clipboard()
        self.setFocusPolicy(QtCore.Qt.StrongFocus)

    def signal(self):
        self.tableWidget_option1.clicked.connect(self.selected_cell)
        self.tableWidget_option2.clicked.connect(self.selected_cell)
        self.tableWidget_option1.cellEntered.connect(self.selected_table)
        self.tableWidget_option2.cellEntered.connect(self.selected_table)
        self.pushButton_clear_option1.clicked.connect(self.clear_option1)
        self.pushButton_clear_option2.clicked.connect(self.clear_option2)
        # self.pushButton_test.clicked.connect(self.test)
        self.pushButton_choose_acc_file.clicked.connect(self.load_acceleration)
        self.pushButton_generate_dat_file.clicked.connect(self.input)
        self.pushButton_shake91_analysis.clicked.connect(self.shake)
        # strong focus

    def shake(self):
        p1 = 'pycharm_generated_shake_input_file.dat'
        p2 = 'py_out1.out'
        p3 = 'py_out2.out'
        win32process.CreateProcess('Shake91.exe', '', None, None, 0,
                                   win32process.CREATE_NEW_CONSOLE, None, None, win32process.STARTUPINFO())
        self.type_in(p1, p2, p3, time_delay=1.0)

    def type_in(self, dat_file, out_1, out_2, time_delay=1.0):
        time.sleep(0.5 * time_delay)
        keyboard = Controller()
        time.sleep(0.5 * time_delay)
        for i in dat_file:
            keyboard.press(i)
            keyboard.release(i)
            time.sleep(0.1 * time_delay)
        keyboard.press(Key.shift)
        keyboard.release(Key.shift)
        keyboard.press(Key.shift)
        keyboard.release(Key.shift)
        keyboard.press(Key.enter)
        keyboard.release(Key.enter)
        time.sleep(0.5 * time_delay)
        for i in out_1:
            keyboard.press(i)
            keyboard.release(i)
            time.sleep(0.1 * time_delay)
        keyboard.press(Key.shift)
        keyboard.release(Key.shift)
        keyboard.press(Key.shift)
        keyboard.release(Key.shift)
        keyboard.press(Key.enter)
        keyboard.release(Key.enter)
        time.sleep(0.5 * time_delay)
        for i in out_2:
            keyboard.press(i)
            keyboard.release(i)
            time.sleep(0.1 * time_delay)
        keyboard.press(Key.shift)
        keyboard.release(Key.shift)
        keyboard.press(Key.shift)
        keyboard.release(Key.shift)
        keyboard.press(Key.enter)
        keyboard.release(Key.enter)

    def initial(self):
        self.setObjectName("Form")
        self.resize(1180, 949)
        self.horizontalLayout_12 = QtWidgets.QHBoxLayout(self)
        self.horizontalLayout_12.setObjectName("horizontalLayout_12")
        self.verticalLayout_6 = QtWidgets.QVBoxLayout()
        self.verticalLayout_6.setObjectName("verticalLayout_6")
        self.groupBox = QtWidgets.QGroupBox(self)
        self.groupBox.setObjectName("groupBox")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.groupBox)
        self.verticalLayout.setObjectName("verticalLayout")
        self.tableWidget_option1 = QtWidgets.QTableWidget(self.groupBox)
        self.tableWidget_option1.setObjectName("tableWidget_option1")
        self.tableWidget_option1.setColumnCount(52)
        self.tableWidget_option1.setRowCount(20)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(11, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(12, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(13, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(14, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(15, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(16, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(17, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(18, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setVerticalHeaderItem(19, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(11, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(12, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(13, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(14, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(15, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(16, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(17, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(18, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(19, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(20, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(21, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(22, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(23, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(24, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(25, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(26, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(27, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(28, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(29, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(30, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(31, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(32, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(33, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(34, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(35, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(36, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(37, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(38, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(39, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(40, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(41, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(42, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(43, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(44, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(45, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(46, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(47, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(48, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(49, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(50, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setHorizontalHeaderItem(51, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(0, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(0, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(1, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(1, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(1, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(2, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(2, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(2, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(2, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(2, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(2, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(2, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(3, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(3, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(3, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(3, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(3, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(3, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(3, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(4, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(4, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(4, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(4, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(4, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(4, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(4, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(4, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(5, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(5, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(5, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(5, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(5, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(5, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(5, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option1.setItem(5, 7, item)
        self.verticalLayout.addWidget(self.tableWidget_option1)
        self.pushButton_clear_option1 = QtWidgets.QPushButton(self.groupBox)
        self.pushButton_clear_option1.setMaximumSize(QtCore.QSize(133, 16777215))
        self.pushButton_clear_option1.setObjectName("pushButton_clear_option1")
        self.verticalLayout.addWidget(self.pushButton_clear_option1)
        self.verticalLayout_6.addWidget(self.groupBox)
        self.horizontalLayout_9 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_9.setObjectName("horizontalLayout_9")
        self.groupBox_2 = QtWidgets.QGroupBox(self)
        self.groupBox_2.setObjectName("groupBox_2")
        self.verticalLayout_7 = QtWidgets.QVBoxLayout(self.groupBox_2)
        self.verticalLayout_7.setObjectName("verticalLayout_7")
        self.tableWidget_option2 = QtWidgets.QTableWidget(self.groupBox_2)
        self.tableWidget_option2.setObjectName("tableWidget_option2")
        self.tableWidget_option2.setColumnCount(6)
        self.tableWidget_option2.setRowCount(69)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(11, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(12, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(13, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(14, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(15, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(16, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(17, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(18, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(19, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(20, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(21, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(22, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(23, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(24, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(25, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(26, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(27, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(28, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(29, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(30, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(31, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(32, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(33, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(34, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(35, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(36, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(37, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(38, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(39, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(40, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(41, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(42, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(43, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(44, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(45, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(46, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(47, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(48, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(49, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(50, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(51, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(52, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(53, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(54, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(55, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(56, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(57, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(58, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(59, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(60, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(61, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(62, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(63, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(64, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(65, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(66, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(67, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setVerticalHeaderItem(68, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_option2.setHorizontalHeaderItem(5, item)
        self.verticalLayout_7.addWidget(self.tableWidget_option2)
        self.pushButton_clear_option2 = QtWidgets.QPushButton(self.groupBox_2)
        self.pushButton_clear_option2.setMaximumSize(QtCore.QSize(133, 16777215))
        self.pushButton_clear_option2.setObjectName("pushButton_clear_option2")
        self.verticalLayout_7.addWidget(self.pushButton_clear_option2)
        self.horizontalLayout_9.addWidget(self.groupBox_2)
        self.verticalLayout_5 = QtWidgets.QVBoxLayout()
        self.verticalLayout_5.setObjectName("verticalLayout_5")
        self.groupBox_3 = QtWidgets.QGroupBox(self)
        self.groupBox_3.setObjectName("groupBox_3")
        self.verticalLayout_8 = QtWidgets.QVBoxLayout(self.groupBox_3)
        self.verticalLayout_8.setObjectName("verticalLayout_8")
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.label_3 = QtWidgets.QLabel(self.groupBox_3)
        self.label_3.setObjectName("label_3")
        self.horizontalLayout_4.addWidget(self.label_3)
        self.lineEdit_option3_acceleration_amplification = QtWidgets.QLineEdit(self.groupBox_3)
        self.lineEdit_option3_acceleration_amplification.setMaximumSize(QtCore.QSize(133, 16777215))
        self.lineEdit_option3_acceleration_amplification.setObjectName("lineEdit_option3_acceleration_amplification")
        self.horizontalLayout_4.addWidget(self.lineEdit_option3_acceleration_amplification)
        self.verticalLayout_8.addLayout(self.horizontalLayout_4)
        self.horizontalLayout_8 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_8.setObjectName("horizontalLayout_8")
        self.label_8 = QtWidgets.QLabel(self.groupBox_3)
        self.label_8.setObjectName("label_8")
        self.horizontalLayout_8.addWidget(self.label_8)
        self.lineEdit_option3_acceleration_interval = QtWidgets.QLineEdit(self.groupBox_3)
        self.lineEdit_option3_acceleration_interval.setMaximumSize(QtCore.QSize(133, 16777215))
        self.lineEdit_option3_acceleration_interval.setObjectName("lineEdit_option3_acceleration_interval")
        self.horizontalLayout_8.addWidget(self.lineEdit_option3_acceleration_interval)
        self.verticalLayout_8.addLayout(self.horizontalLayout_8)
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.label_5 = QtWidgets.QLabel(self.groupBox_3)
        self.label_5.setMaximumSize(QtCore.QSize(16777215, 16777215))
        self.label_5.setObjectName("label_5")
        self.horizontalLayout.addWidget(self.label_5)
        self.lineEdit_acc_file = QtWidgets.QLineEdit(self.groupBox_3)
        self.lineEdit_acc_file.setMaximumSize(QtCore.QSize(96, 16777215))
        self.lineEdit_acc_file.setObjectName("lineEdit_acc_file")
        self.horizontalLayout.addWidget(self.lineEdit_acc_file)
        self.pushButton_choose_acc_file = QtWidgets.QPushButton(self.groupBox_3)
        self.pushButton_choose_acc_file.setMaximumSize(QtCore.QSize(30, 16777215))
        self.pushButton_choose_acc_file.setObjectName("pushButton_choose_acc_file")
        self.horizontalLayout.addWidget(self.pushButton_choose_acc_file)
        self.verticalLayout_8.addLayout(self.horizontalLayout)
        self.horizontalLayout_11 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_11.setObjectName("horizontalLayout_11")
        self.label_9 = QtWidgets.QLabel(self.groupBox_3)
        self.label_9.setObjectName("label_9")
        self.horizontalLayout_11.addWidget(self.label_9)
        self.lineEdit_option3_acceleration_format = QtWidgets.QLineEdit(self.groupBox_3)
        self.lineEdit_option3_acceleration_format.setMaximumSize(QtCore.QSize(133, 16777215))
        self.lineEdit_option3_acceleration_format.setObjectName("lineEdit_option3_acceleration_format")
        self.horizontalLayout_11.addWidget(self.lineEdit_option3_acceleration_format)
        self.verticalLayout_8.addLayout(self.horizontalLayout_11)
        self.verticalLayout_5.addWidget(self.groupBox_3)
        self.groupBox_4 = QtWidgets.QGroupBox(self)
        self.groupBox_4.setObjectName("groupBox_4")
        self.verticalLayout_4 = QtWidgets.QVBoxLayout(self.groupBox_4)
        self.verticalLayout_4.setObjectName("verticalLayout_4")
        self.horizontalLayout_6 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_6.setObjectName("horizontalLayout_6")
        self.label_6 = QtWidgets.QLabel(self.groupBox_4)
        self.label_6.setObjectName("label_6")
        self.horizontalLayout_6.addWidget(self.label_6)
        self.comboBox_option4_input_layer = QtWidgets.QComboBox(self.groupBox_4)
        self.comboBox_option4_input_layer.setMaximumSize(QtCore.QSize(133, 16777215))
        self.comboBox_option4_input_layer.setObjectName("comboBox_option4_input_layer")
        self.comboBox_option4_input_layer.addItem("")
        self.comboBox_option4_input_layer.addItem("")
        self.horizontalLayout_6.addWidget(self.comboBox_option4_input_layer)
        self.verticalLayout_4.addLayout(self.horizontalLayout_6)
        self.horizontalLayout_7 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_7.setObjectName("horizontalLayout_7")
        self.label_7 = QtWidgets.QLabel(self.groupBox_4)
        self.label_7.setObjectName("label_7")
        self.horizontalLayout_7.addWidget(self.label_7)
        self.comboBox_option4_input_type = QtWidgets.QComboBox(self.groupBox_4)
        self.comboBox_option4_input_type.setMaximumSize(QtCore.QSize(133, 16777215))
        self.comboBox_option4_input_type.setObjectName("comboBox_option4_input_type")
        self.comboBox_option4_input_type.addItem("")
        self.comboBox_option4_input_type.addItem("")
        self.horizontalLayout_7.addWidget(self.comboBox_option4_input_type)
        self.verticalLayout_4.addLayout(self.horizontalLayout_7)
        self.verticalLayout_5.addWidget(self.groupBox_4)
        self.groupBox_5 = QtWidgets.QGroupBox(self)
        self.groupBox_5.setObjectName("groupBox_5")
        self.verticalLayout_3 = QtWidgets.QVBoxLayout(self.groupBox_5)
        self.verticalLayout_3.setObjectName("verticalLayout_3")
        self.horizontalLayout_5 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_5.setObjectName("horizontalLayout_5")
        self.label_4 = QtWidgets.QLabel(self.groupBox_5)
        self.label_4.setObjectName("label_4")
        self.horizontalLayout_5.addWidget(self.label_4)
        self.lineEdit_option5_earthquake_magnitude = QtWidgets.QLineEdit(self.groupBox_5)
        self.lineEdit_option5_earthquake_magnitude.setMaximumSize(QtCore.QSize(133, 16777215))
        self.lineEdit_option5_earthquake_magnitude.setObjectName("lineEdit_option5_earthquake_magnitude")
        self.horizontalLayout_5.addWidget(self.lineEdit_option5_earthquake_magnitude)
        self.verticalLayout_3.addLayout(self.horizontalLayout_5)
        self.verticalLayout_5.addWidget(self.groupBox_5)
        self.groupBox_6 = QtWidgets.QGroupBox(self)
        self.groupBox_6.setObjectName("groupBox_6")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.groupBox_6)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.label = QtWidgets.QLabel(self.groupBox_6)
        self.label.setObjectName("label")
        self.horizontalLayout_2.addWidget(self.label)
        self.comboBox_option6_sublayer_type_bottom = QtWidgets.QComboBox(self.groupBox_6)
        self.comboBox_option6_sublayer_type_bottom.setMaximumSize(QtCore.QSize(133, 16777215))
        self.comboBox_option6_sublayer_type_bottom.setObjectName("comboBox_option6_sublayer_type_bottom")
        self.comboBox_option6_sublayer_type_bottom.addItem("")
        self.comboBox_option6_sublayer_type_bottom.addItem("")
        self.horizontalLayout_2.addWidget(self.comboBox_option6_sublayer_type_bottom)
        self.verticalLayout_2.addLayout(self.horizontalLayout_2)
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.label_2 = QtWidgets.QLabel(self.groupBox_6)
        self.label_2.setObjectName("label_2")
        self.horizontalLayout_3.addWidget(self.label_2)
        self.comboBox_option6_sublayer_type_surface = QtWidgets.QComboBox(self.groupBox_6)
        self.comboBox_option6_sublayer_type_surface.setMaximumSize(QtCore.QSize(133, 16777215))
        self.comboBox_option6_sublayer_type_surface.setObjectName("comboBox_option6_sublayer_type_surface")
        self.comboBox_option6_sublayer_type_surface.addItem("")
        self.comboBox_option6_sublayer_type_surface.addItem("")
        self.horizontalLayout_3.addWidget(self.comboBox_option6_sublayer_type_surface)
        self.verticalLayout_2.addLayout(self.horizontalLayout_3)
        self.verticalLayout_5.addWidget(self.groupBox_6)
        self.horizontalLayout_9.addLayout(self.verticalLayout_5)
        self.horizontalLayout_9.setStretch(0, 2)
        self.horizontalLayout_9.setStretch(1, 1)
        self.verticalLayout_6.addLayout(self.horizontalLayout_9)
        self.horizontalLayout_10 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_10.setObjectName("horizontalLayout_10")
        spacerItem = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.horizontalLayout_10.addItem(spacerItem)
        self.pushButton_generate_dat_file = QtWidgets.QPushButton(self)
        self.pushButton_generate_dat_file.setMaximumSize(QtCore.QSize(133, 16777215))
        self.pushButton_generate_dat_file.setObjectName("pushButton_generate_dat_file")
        self.horizontalLayout_10.addWidget(self.pushButton_generate_dat_file)
        self.pushButton_shake91_analysis = QtWidgets.QPushButton(self)
        self.pushButton_shake91_analysis.setMaximumSize(QtCore.QSize(133, 16777215))
        self.pushButton_shake91_analysis.setObjectName("pushButton_shake91_analysis")
        self.horizontalLayout_10.addWidget(self.pushButton_shake91_analysis)
        self.pushButton_import_abaqus = QtWidgets.QPushButton(self)
        self.pushButton_import_abaqus.setMaximumSize(QtCore.QSize(133, 16777215))
        self.pushButton_import_abaqus.setObjectName("pushButton_import_abaqus")
        self.horizontalLayout_10.addWidget(self.pushButton_import_abaqus)
        self.pushButton_test = QtWidgets.QPushButton(self)
        self.pushButton_test.setMaximumSize(QtCore.QSize(133, 16777215))
        self.pushButton_test.setObjectName("pushButton_test")
        self.horizontalLayout_10.addWidget(self.pushButton_test)
        self.verticalLayout_6.addLayout(self.horizontalLayout_10)
        self.verticalLayout_6.setStretch(0, 6)
        self.verticalLayout_6.setStretch(1, 4)
        self.verticalLayout_6.setStretch(2, 1)
        self.horizontalLayout_12.addLayout(self.verticalLayout_6)

        QtCore.QMetaObject.connectSlotsByName(self)

        _translate = QtCore.QCoreApplication.translate
        self.setWindowTitle(_translate("Form", "Form"))
        self.groupBox.setTitle(_translate("Form", "option1 土的动力特性曲线"))
        item = self.tableWidget_option1.verticalHeaderItem(0)
        item.setText(_translate("Form", "1"))
        item = self.tableWidget_option1.verticalHeaderItem(1)
        item.setText(_translate("Form", "2"))
        item = self.tableWidget_option1.verticalHeaderItem(2)
        item.setText(_translate("Form", "3"))
        item = self.tableWidget_option1.verticalHeaderItem(3)
        item.setText(_translate("Form", "4"))
        item = self.tableWidget_option1.verticalHeaderItem(4)
        item.setText(_translate("Form", "5"))
        item = self.tableWidget_option1.verticalHeaderItem(5)
        item.setText(_translate("Form", "6"))
        item = self.tableWidget_option1.verticalHeaderItem(6)
        item.setText(_translate("Form", "7"))
        item = self.tableWidget_option1.verticalHeaderItem(7)
        item.setText(_translate("Form", "8"))
        item = self.tableWidget_option1.verticalHeaderItem(8)
        item.setText(_translate("Form", "9"))
        item = self.tableWidget_option1.verticalHeaderItem(9)
        item.setText(_translate("Form", "10"))
        item = self.tableWidget_option1.verticalHeaderItem(10)
        item.setText(_translate("Form", "11"))
        item = self.tableWidget_option1.verticalHeaderItem(11)
        item.setText(_translate("Form", "12"))
        item = self.tableWidget_option1.verticalHeaderItem(12)
        item.setText(_translate("Form", "13"))
        item = self.tableWidget_option1.verticalHeaderItem(13)
        item.setText(_translate("Form", "14"))
        item = self.tableWidget_option1.verticalHeaderItem(14)
        item.setText(_translate("Form", "15"))
        item = self.tableWidget_option1.verticalHeaderItem(15)
        item.setText(_translate("Form", "16"))
        item = self.tableWidget_option1.verticalHeaderItem(16)
        item.setText(_translate("Form", "17"))
        item = self.tableWidget_option1.verticalHeaderItem(17)
        item.setText(_translate("Form", "18"))
        item = self.tableWidget_option1.verticalHeaderItem(18)
        item.setText(_translate("Form", "19"))
        item = self.tableWidget_option1.verticalHeaderItem(19)
        item.setText(_translate("Form", "20"))
        item = self.tableWidget_option1.horizontalHeaderItem(0)
        item.setText(_translate("Form", "1-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(1)
        item.setText(_translate("Form", "1-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(2)
        item.setText(_translate("Form", "1-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(3)
        item.setText(_translate("Form", "1-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(4)
        item.setText(_translate("Form", "2-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(5)
        item.setText(_translate("Form", "2-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(6)
        item.setText(_translate("Form", "2-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(7)
        item.setText(_translate("Form", "2-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(8)
        item.setText(_translate("Form", "3-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(9)
        item.setText(_translate("Form", "3-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(10)
        item.setText(_translate("Form", "3-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(11)
        item.setText(_translate("Form", "3-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(12)
        item.setText(_translate("Form", "4-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(13)
        item.setText(_translate("Form", "4-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(14)
        item.setText(_translate("Form", "4-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(15)
        item.setText(_translate("Form", "4-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(16)
        item.setText(_translate("Form", "5-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(17)
        item.setText(_translate("Form", "5-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(18)
        item.setText(_translate("Form", "5-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(19)
        item.setText(_translate("Form", "5-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(20)
        item.setText(_translate("Form", "6-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(21)
        item.setText(_translate("Form", "6-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(22)
        item.setText(_translate("Form", "6-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(23)
        item.setText(_translate("Form", "6-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(24)
        item.setText(_translate("Form", "7-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(25)
        item.setText(_translate("Form", "7-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(26)
        item.setText(_translate("Form", "7-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(27)
        item.setText(_translate("Form", "7-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(28)
        item.setText(_translate("Form", "8-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(29)
        item.setText(_translate("Form", "8-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(30)
        item.setText(_translate("Form", "8-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(31)
        item.setText(_translate("Form", "8-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(32)
        item.setText(_translate("Form", "9-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(33)
        item.setText(_translate("Form", "9-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(34)
        item.setText(_translate("Form", "9-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(35)
        item.setText(_translate("Form", "9-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(36)
        item.setText(_translate("Form", "10-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(37)
        item.setText(_translate("Form", "10-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(38)
        item.setText(_translate("Form", "10-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(39)
        item.setText(_translate("Form", "10-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(40)
        item.setText(_translate("Form", "11-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(41)
        item.setText(_translate("Form", "11-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(42)
        item.setText(_translate("Form", "11-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(43)
        item.setText(_translate("Form", "11-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(44)
        item.setText(_translate("Form", "12-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(45)
        item.setText(_translate("Form", "12-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(46)
        item.setText(_translate("Form", "12-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(47)
        item.setText(_translate("Form", "12-阻尼比曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(48)
        item.setText(_translate("Form", "13-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(49)
        item.setText(_translate("Form", "13-剪切模量曲线"))
        item = self.tableWidget_option1.horizontalHeaderItem(50)
        item.setText(_translate("Form", "13-剪应变 (%)"))
        item = self.tableWidget_option1.horizontalHeaderItem(51)
        item.setText(_translate("Form", "13-阻尼比曲线"))
        __sortingEnabled = self.tableWidget_option1.isSortingEnabled()
        self.tableWidget_option1.setSortingEnabled(False)
        item = self.tableWidget_option1.item(0, 0)
        item.setText(_translate("Form", "1"))
        item = self.tableWidget_option1.item(0, 1)
        item.setText(_translate("Form", "2"))
        item = self.tableWidget_option1.item(0, 2)
        item.setText(_translate("Form", "3"))
        item = self.tableWidget_option1.item(0, 3)
        item.setText(_translate("Form", "44.7"))
        item = self.tableWidget_option1.item(0, 4)
        item.setText(_translate("Form", "44.7"))
        item = self.tableWidget_option1.item(0, 5)
        item.setText(_translate("Form", "44.7"))
        item = self.tableWidget_option1.item(0, 6)
        item.setText(_translate("Form", "44.7"))
        item = self.tableWidget_option1.item(0, 7)
        item.setText(_translate("Form", "44.7"))
        item = self.tableWidget_option1.item(1, 0)
        item.setText(_translate("Form", "44"))
        item = self.tableWidget_option1.item(1, 1)
        item.setText(_translate("Form", "42"))
        item = self.tableWidget_option1.item(1, 2)
        item.setText(_translate("Form", "123"))
        item = self.tableWidget_option1.item(1, 3)
        item.setText(_translate("Form", "44.7"))
        item = self.tableWidget_option1.item(1, 4)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(1, 5)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(1, 6)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(1, 7)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(2, 0)
        item.setText(_translate("Form", "44.7"))
        item = self.tableWidget_option1.item(2, 1)
        item.setText(_translate("Form", "4"))
        item = self.tableWidget_option1.item(2, 2)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(2, 3)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(2, 4)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(2, 5)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(2, 6)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(2, 7)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(3, 0)
        item.setText(_translate("Form", "2.8"))
        item = self.tableWidget_option1.item(3, 1)
        item.setText(_translate("Form", "4.9"))
        item = self.tableWidget_option1.item(3, 2)
        item.setText(_translate("Form", "4.9"))
        item = self.tableWidget_option1.item(3, 3)
        item.setText(_translate("Form", "2.8"))
        item = self.tableWidget_option1.item(3, 4)
        item.setText(_translate("Form", "2.8"))
        item = self.tableWidget_option1.item(3, 5)
        item.setText(_translate("Form", "2.8"))
        item = self.tableWidget_option1.item(3, 6)
        item.setText(_translate("Form", "2.8"))
        item = self.tableWidget_option1.item(3, 7)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option1.item(4, 0)
        item.setText(_translate("Form", "7"))
        item = self.tableWidget_option1.item(4, 1)
        item.setText(_translate("Form", "4.9"))
        item = self.tableWidget_option1.item(4, 2)
        item.setText(_translate("Form", "7"))
        item = self.tableWidget_option1.item(4, 3)
        item.setText(_translate("Form", "4.9"))
        item = self.tableWidget_option1.item(4, 4)
        item.setText(_translate("Form", "9"))
        item = self.tableWidget_option1.item(4, 5)
        item.setText(_translate("Form", "4.9"))
        item = self.tableWidget_option1.item(4, 6)
        item.setText(_translate("Form", "2.8"))
        item = self.tableWidget_option1.item(4, 7)
        item.setText(_translate("Form", "2.8"))
        item = self.tableWidget_option1.item(5, 0)
        item.setText(_translate("Form", "9"))
        item = self.tableWidget_option1.item(5, 1)
        item.setText(_translate("Form", "4.9"))
        item = self.tableWidget_option1.item(5, 2)
        item.setText(_translate("Form", "7"))
        item = self.tableWidget_option1.item(5, 3)
        item.setText(_translate("Form", "4.9"))
        item = self.tableWidget_option1.item(5, 4)
        item.setText(_translate("Form", "9"))
        item = self.tableWidget_option1.item(5, 5)
        item.setText(_translate("Form", "4.9"))
        item = self.tableWidget_option1.item(5, 6)
        item.setText(_translate("Form", "2.8"))
        item = self.tableWidget_option1.item(5, 7)
        item.setText(_translate("Form", "2.8"))
        self.tableWidget_option1.setSortingEnabled(__sortingEnabled)
        self.pushButton_clear_option1.setText(_translate("Form", "清除"))
        self.groupBox_2.setTitle(_translate("Form", "option2 土层分层信息"))
        item = self.tableWidget_option2.verticalHeaderItem(0)
        item.setText(_translate("Form", "1"))
        item = self.tableWidget_option2.verticalHeaderItem(1)
        item.setText(_translate("Form", "2"))
        item = self.tableWidget_option2.verticalHeaderItem(2)
        item.setText(_translate("Form", "3"))
        item = self.tableWidget_option2.verticalHeaderItem(3)
        item.setText(_translate("Form", "4"))
        item = self.tableWidget_option2.verticalHeaderItem(4)
        item.setText(_translate("Form", "5"))
        item = self.tableWidget_option2.verticalHeaderItem(5)
        item.setText(_translate("Form", "6"))
        item = self.tableWidget_option2.verticalHeaderItem(6)
        item.setText(_translate("Form", "7"))
        item = self.tableWidget_option2.verticalHeaderItem(7)
        item.setText(_translate("Form", "8"))
        item = self.tableWidget_option2.verticalHeaderItem(8)
        item.setText(_translate("Form", "9"))
        item = self.tableWidget_option2.verticalHeaderItem(9)
        item.setText(_translate("Form", "10"))
        item = self.tableWidget_option2.verticalHeaderItem(10)
        item.setText(_translate("Form", "11"))
        item = self.tableWidget_option2.verticalHeaderItem(11)
        item.setText(_translate("Form", "12"))
        item = self.tableWidget_option2.verticalHeaderItem(12)
        item.setText(_translate("Form", "13"))
        item = self.tableWidget_option2.verticalHeaderItem(13)
        item.setText(_translate("Form", "14"))
        item = self.tableWidget_option2.verticalHeaderItem(14)
        item.setText(_translate("Form", "15"))
        item = self.tableWidget_option2.verticalHeaderItem(15)
        item.setText(_translate("Form", "16"))
        item = self.tableWidget_option2.verticalHeaderItem(16)
        item.setText(_translate("Form", "17"))
        item = self.tableWidget_option2.verticalHeaderItem(17)
        item.setText(_translate("Form", "18"))
        item = self.tableWidget_option2.verticalHeaderItem(18)
        item.setText(_translate("Form", "19"))
        item = self.tableWidget_option2.verticalHeaderItem(19)
        item.setText(_translate("Form", "20"))
        item = self.tableWidget_option2.verticalHeaderItem(20)
        item.setText(_translate("Form", "21"))
        item = self.tableWidget_option2.verticalHeaderItem(21)
        item.setText(_translate("Form", "22"))
        item = self.tableWidget_option2.verticalHeaderItem(22)
        item.setText(_translate("Form", "23"))
        item = self.tableWidget_option2.verticalHeaderItem(23)
        item.setText(_translate("Form", "24"))
        item = self.tableWidget_option2.verticalHeaderItem(24)
        item.setText(_translate("Form", "25"))
        item = self.tableWidget_option2.verticalHeaderItem(25)
        item.setText(_translate("Form", "27"))
        item = self.tableWidget_option2.verticalHeaderItem(26)
        item.setText(_translate("Form", "272"))
        item = self.tableWidget_option2.verticalHeaderItem(27)
        item.setText(_translate("Form", "28"))
        item = self.tableWidget_option2.verticalHeaderItem(28)
        item.setText(_translate("Form", "29"))
        item = self.tableWidget_option2.verticalHeaderItem(29)
        item.setText(_translate("Form", "30"))
        item = self.tableWidget_option2.verticalHeaderItem(30)
        item.setText(_translate("Form", "31"))
        item = self.tableWidget_option2.verticalHeaderItem(31)
        item.setText(_translate("Form", "32"))
        item = self.tableWidget_option2.verticalHeaderItem(32)
        item.setText(_translate("Form", "33"))
        item = self.tableWidget_option2.verticalHeaderItem(33)
        item.setText(_translate("Form", "34"))
        item = self.tableWidget_option2.verticalHeaderItem(34)
        item.setText(_translate("Form", "35"))
        item = self.tableWidget_option2.verticalHeaderItem(35)
        item.setText(_translate("Form", "36"))
        item = self.tableWidget_option2.verticalHeaderItem(36)
        item.setText(_translate("Form", "37"))
        item = self.tableWidget_option2.verticalHeaderItem(37)
        item.setText(_translate("Form", "38"))
        item = self.tableWidget_option2.verticalHeaderItem(38)
        item.setText(_translate("Form", "39"))
        item = self.tableWidget_option2.verticalHeaderItem(39)
        item.setText(_translate("Form", "40"))
        item = self.tableWidget_option2.verticalHeaderItem(40)
        item.setText(_translate("Form", "41"))
        item = self.tableWidget_option2.verticalHeaderItem(41)
        item.setText(_translate("Form", "42"))
        item = self.tableWidget_option2.verticalHeaderItem(42)
        item.setText(_translate("Form", "43"))
        item = self.tableWidget_option2.verticalHeaderItem(43)
        item.setText(_translate("Form", "45"))
        item = self.tableWidget_option2.verticalHeaderItem(44)
        item.setText(_translate("Form", "454"))
        item = self.tableWidget_option2.verticalHeaderItem(45)
        item.setText(_translate("Form", "46"))
        item = self.tableWidget_option2.verticalHeaderItem(46)
        item.setText(_translate("Form", "47"))
        item = self.tableWidget_option2.verticalHeaderItem(47)
        item.setText(_translate("Form", "48"))
        item = self.tableWidget_option2.verticalHeaderItem(48)
        item.setText(_translate("Form", "49"))
        item = self.tableWidget_option2.verticalHeaderItem(49)
        item.setText(_translate("Form", "50"))
        item = self.tableWidget_option2.verticalHeaderItem(50)
        item.setText(_translate("Form", "51"))
        item = self.tableWidget_option2.verticalHeaderItem(51)
        item.setText(_translate("Form", "52"))
        item = self.tableWidget_option2.verticalHeaderItem(52)
        item.setText(_translate("Form", "53"))
        item = self.tableWidget_option2.verticalHeaderItem(53)
        item.setText(_translate("Form", "54"))
        item = self.tableWidget_option2.verticalHeaderItem(54)
        item.setText(_translate("Form", "55"))
        item = self.tableWidget_option2.verticalHeaderItem(55)
        item.setText(_translate("Form", "56"))
        item = self.tableWidget_option2.verticalHeaderItem(56)
        item.setText(_translate("Form", "57"))
        item = self.tableWidget_option2.verticalHeaderItem(57)
        item.setText(_translate("Form", "58"))
        item = self.tableWidget_option2.verticalHeaderItem(58)
        item.setText(_translate("Form", "59"))
        item = self.tableWidget_option2.verticalHeaderItem(59)
        item.setText(_translate("Form", "60"))
        item = self.tableWidget_option2.verticalHeaderItem(60)
        item.setText(_translate("Form", "61"))
        item = self.tableWidget_option2.verticalHeaderItem(61)
        item.setText(_translate("Form", "62"))
        item = self.tableWidget_option2.verticalHeaderItem(62)
        item.setText(_translate("Form", "63"))
        item = self.tableWidget_option2.verticalHeaderItem(63)
        item.setText(_translate("Form", "64"))
        item = self.tableWidget_option2.verticalHeaderItem(64)
        item.setText(_translate("Form", "65"))
        item = self.tableWidget_option2.verticalHeaderItem(65)
        item.setText(_translate("Form", "66"))
        item = self.tableWidget_option2.verticalHeaderItem(66)
        item.setText(_translate("Form", "67"))
        item = self.tableWidget_option2.verticalHeaderItem(67)
        item.setText(_translate("Form", "68"))
        item = self.tableWidget_option2.verticalHeaderItem(68)
        item.setText(_translate("Form", "70"))
        item = self.tableWidget_option2.horizontalHeaderItem(0)
        item.setText(_translate("Form", "土层编号"))
        item = self.tableWidget_option2.horizontalHeaderItem(1)
        item.setText(_translate("Form", "土层类别"))
        item = self.tableWidget_option2.horizontalHeaderItem(2)
        item.setText(_translate("Form", "层厚 (m)"))
        item = self.tableWidget_option2.horizontalHeaderItem(3)
        item.setText(_translate("Form", "初始阻尼比"))
        item = self.tableWidget_option2.horizontalHeaderItem(4)
        item.setText(_translate("Form", "重度 (kN/m³)"))
        item = self.tableWidget_option2.horizontalHeaderItem(5)
        item.setText(_translate("Form", "最大Vs (m/s)"))
        self.pushButton_clear_option2.setText(_translate("Form", "清除"))
        self.groupBox_3.setTitle(_translate("Form", "option3 地震波"))
        self.label_3.setText(_translate("Form", "加速度调幅系数"))
        self.lineEdit_option3_acceleration_amplification.setText(_translate("Form", "1.0"))
        self.lineEdit_option3_acceleration_amplification.setPlaceholderText(_translate("Form", "1.0"))
        self.label_8.setText(_translate("Form", "加速度时间间隔"))
        self.lineEdit_option3_acceleration_interval.setText(_translate("Form", "0.01"))
        self.lineEdit_option3_acceleration_interval.setPlaceholderText(_translate("Form", "1.0"))
        self.label_5.setText(_translate("Form", "加速度文件"))
        self.pushButton_choose_acc_file.setText(_translate("Form", ".."))
        self.label_9.setText(_translate("Form", "加速度输入格式"))
        self.lineEdit_option3_acceleration_format.setText(_translate("Form", "(8f10.6)"))
        self.lineEdit_option3_acceleration_format.setPlaceholderText(_translate("Form", "1.0"))
        self.groupBox_4.setTitle(_translate("Form", "option4 地震波输入位置"))
        self.label_6.setText(_translate("Form", "输入位置"))
        self.comboBox_option4_input_layer.setItemText(0, _translate("Form", "底部"))
        self.comboBox_option4_input_layer.setItemText(1, _translate("Form", "顶部"))
        self.label_7.setText(_translate("Form", "输入类型"))
        self.comboBox_option4_input_type.setItemText(0, _translate("Form", "within"))
        self.comboBox_option4_input_type.setItemText(1, _translate("Form", "outcrop"))
        self.groupBox_5.setTitle(_translate("Form", "option5 迭代次数和震级"))
        self.label_4.setText(_translate("Form", "震级"))
        self.lineEdit_option5_earthquake_magnitude.setText(_translate("Form", "7"))
        self.groupBox_6.setTitle(_translate("Form", "option6 下卧层类型"))
        self.label.setText(_translate("Form", "底层"))
        self.comboBox_option6_sublayer_type_bottom.setItemText(0, _translate("Form", "0-outcrop"))
        self.comboBox_option6_sublayer_type_bottom.setItemText(1, _translate("Form", "1-within"))
        self.label_2.setText(_translate("Form", "顶层"))
        self.comboBox_option6_sublayer_type_surface.setItemText(0, _translate("Form", "0-outcrop"))
        self.comboBox_option6_sublayer_type_surface.setItemText(1, _translate("Form", "1-within"))
        self.pushButton_generate_dat_file.setText(_translate("Form", "生成dat文件"))
        self.pushButton_shake91_analysis.setText(_translate("Form", "shake91分析"))
        self.pushButton_import_abaqus.setText(_translate("Form", "导入abaqus"))
        self.pushButton_test.setText(_translate("Form", "*"))

    def input(self):
        self.shear_strain_shear_modulus, self.shear_modulus_curve, \
        self.shear_strain_damping, self.damping_curve = self.get_option1_table_widget()

        self.soil_number, self.soil_type, self.soil_thickness, self.soil_initial_damping, \
        self.soil_unit_weight, self.soil_vs_max = self.get_option2_table_widget()

        with open('pycharm_generated_shake_input_file.dat', 'w') as f:
            # option1
            f.write('option 1 - dynamic soil properties\n')
            f.write('    1\n')
            f.write('{:5d}\n'.format(np.shape(self.shear_strain_shear_modulus)[0]))
            for i in range(np.shape(self.shear_strain_shear_modulus)[0]):
                # G_max curve
                f.write('{:5d} #{} modulus reduction for soil type {}\n'.format(int(np.shape(self.shear_strain_shear_modulus)[1]), i, i))
                for j in range(np.shape(self.shear_strain_shear_modulus)[1]):
                    f.write('{:<10.5f}'.format(self.shear_strain_shear_modulus[i][j]))
                f.write('\n')
                for j in range(np.shape(self.shear_strain_shear_modulus)[1]):
                    f.write('{:<10.3f}'.format(self.shear_modulus_curve[i][j]))
                f.write('\n')
                # damping curve
                f.write('{:5d} #{} damping for soil type {}\n'.format(int(np.shape(self.shear_strain_shear_modulus)[1]), i, i))
                for j in range(np.shape(self.shear_strain_shear_modulus)[1]):
                    f.write('{:<10.5f}'.format(self.shear_strain_shear_modulus[i][j]))
                f.write('\n')
                for j in range(np.shape(self.shear_strain_shear_modulus)[1]):
                    f.write('{:<10.3f}'.format(self.shear_modulus_curve[i][j]))
                f.write('\n')

            soil_type = self.soil_type
            input_type = []
            for i in soil_type:
                if i not in input_type:
                    input_type.append(i)

            f.write('{:5d}'.format(len(input_type)))
            for i in input_type:
                f.write('{:5d}'.format(int(i)))
            f.write('\n')

            # option2
            f.write('option 2 -- soil profile\n')
            f.write('    2\n')
            f.write('    1{:5d}\n'.format(np.shape(self.soil_number)[0]))
            for i in range(np.shape(self.soil_number)[0]):
                if i < np.shape(self.soil_number)[0] - 1:
                    f.write('{:5d}'.format(int(self.soil_number[i])))
                    f.write('{:5d}'.format(int(self.soil_type[i])))
                    f.write('{:15.4f}'.format(self.soil_thickness[i]))
                    f.write('{:20.2f}'.format(self.soil_initial_damping[i]))
                    f.write('{:10.4f}'.format(self.soil_unit_weight[i]))
                    f.write('{:10.4f}'.format(self.soil_vs_max[i]))
                else:
                    f.write('{:5d}'.format(int(self.soil_number[i])))
                    f.write('{:5d}'.format(int(self.soil_type[i])))
                    f.write('{:35.2f}'.format(self.soil_initial_damping[i]))
                    f.write('{:10.4f}'.format(self.soil_unit_weight[i]))
                    f.write('{:10.4f}'.format(self.soil_vs_max[i]))
                f.write('\n')

            # option3
            f.write('option 3 -- input motion\n')
            f.write('    3\n')
            f.write('{:5d}{:5d}{:10.2f}{:^30s}{:>12s}\n'.format(self.get_acc_length(), 4096,
                                                float(self.lineEdit_option3_acceleration_interval.text()),
                                                      self.lineEdit_acc_file.text(),
                                                      self.lineEdit_option3_acceleration_format.text()))
            f.write('{:20f}{:10.1f}{:5d}{:5d}\n'.format(self.get_acc_max() * float(self.lineEdit_option3_acceleration_amplification.text()),
                                                    25.0, self.get_acc_header_lines(), self.get_acc_number_per_line()))

            # option4
            f.write('option 4 --sublayer where input motion is applied (within or cropping)\n')
            f.write('    4\n')
            input_layer = self.comboBox_option4_input_layer.currentText()
            input_type = self.comboBox_option4_input_type.currentText()
            if input_layer == '底部' and input_type == 'within':
                f.write('{:5d}{:5d}'.format(self.soil_number[-1], 1))
            if input_layer == '底部' and input_type == 'outcrop':
                f.write('{:5d}{:5d}'.format(self.soil_number[-1], 0))
            if input_layer == '顶部' and input_type == 'within':
                f.write('{:5d}{:5d}'.format(self.soil_number[0], 1))
            if input_layer == '顶部' and input_type == 'outcrop':
                f.write('{:5d}{:5d}'.format(self.soil_number[0], 0))
            f.write('\n')

            # option5
            f.write('option 5 --number of iteraction & ratio of avg strain to max strain\n')
            f.write('    5\n')
            try:
                f.write('{:5d}{:5d}{:10.2f}'.format(1, 20,
                                                    0.1 * (float(self.lineEdit_option5_earthquake_magnitude.text()) - 1.0)))
            except:
                QMessageBox.about(self, "错误", "检查option5输入格式")
            f.write('\n')

            # option6
            f.write('option 6 --sublayers for which accn. time histories are to computed & saved\n')
            f.write('    6\n')

            total_layers = int(np.shape(self.soil_number)[0])
            option6_lines = int((total_layers - 1) / 15) + 1
            if option6_lines == 1:
                for i in range(np.shape(self.soil_number)[0]):
                    f.write('{:5d}'.format(self.soil_number[i]))
                f.write('\n')
                for i in range(np.shape(self.soil_number)[0]):
                    f.write('{:5d}'.format(1))
                f.write('\n')
                # outcrop/within
                if self.comboBox_option6_sublayer_type_bottom.currentText() == '0-outcrop':
                    f.write('{:5d}'.format(0))
                if self.comboBox_option6_sublayer_type_bottom.currentText() == '1-within':
                    f.write('{:5d}'.format(1))
                for i in range(np.shape(self.soil_number)[0] - 2):
                    f.write('{:5d}'.format(1))
                if self.comboBox_option6_sublayer_type_surface.currentText() == '0-outcrop':
                    f.write('{:5d}'.format(0))
                if self.comboBox_option6_sublayer_type_surface.currentText() == '1-within':
                    f.write('{:5d}'.format(1))
                f.write('\n')
            else:
                for i in range(15):
                    f.write('{:5d}'.format(self.soil_number[i]))
                f.write('\n')
                for i in range(15):
                    f.write('{:5d}'.format(1))
                f.write('\n')
                # outcrop/within
                if self.comboBox_option6_sublayer_type_bottom.currentText() == '0-outcrop':
                    f.write('{:5d}'.format(0))
                if self.comboBox_option6_sublayer_type_bottom.currentText() == '1-within':
                    f.write('{:5d}'.format(1))
                for i in range(14):
                    f.write('{:5d}'.format(1))
                f.write('\noption 6 --sublayers for which accn. time histories are to computed & saved\n')
                f.write('    6\n')
                if option6_lines > 2:
                    for j in range(option6_lines - 2):
                        for i in range(15):
                            f.write('{:5d}'.format(self.soil_number[15 * j + 15 + i]))
                        f.write('\n')
                        for i in range(15):
                            f.write('{:5d}'.format(1))
                        f.write('\n')
                        for i in range(15):
                            f.write('{:5d}'.format(1))
                        f.write('\noption 6 --sublayers for which accn. time histories are to computed & saved\n')
                        f.write('    6\n')
                    # 最后一行
                    for i in range(total_layers - (option6_lines - 1) * 15):
                        f.write('{:5d}'.format(self.soil_number[(option6_lines - 1) * 15 + i]))
                    f.write('\n')
                    for i in range(total_layers - (option6_lines - 1) * 15):
                        f.write('{:5d}'.format(1))
                    f.write('\n')
                    if total_layers > 1 + (option6_lines - 1) * 15:
                        for i in range(total_layers - (option6_lines - 1) * 15 - 1):
                            f.write('{:5d}'.format(1))
                    if self.comboBox_option6_sublayer_type_surface.currentText() == '0-outcrop':
                        f.write('{:5d}'.format(0))
                    if self.comboBox_option6_sublayer_type_surface.currentText() == '1-within':
                        f.write('{:5d}'.format(1))
                else:
                    for i in range(total_layers - 15):
                        f.write('{:5d}'.format(self.soil_number[15 + i]))
                    f.write('\n')
                    for i in range(total_layers - 15):
                        f.write('{:5d}'.format(1))
                    f.write('\n')
                    if total_layers > 16:
                        for i in range(total_layers - 16):
                            f.write('{:5d}'.format(1))
                    if self.comboBox_option6_sublayer_type_surface.currentText() == '0-outcrop':
                        f.write('{:5d}'.format(0))
                    if self.comboBox_option6_sublayer_type_surface.currentText() == '1-within':
                        f.write('{:5d}'.format(1))
                    f.write('\n')

            # option7
            for i in range(total_layers - 1):
                f.write('option 7 -- sublayer for which shear stresses or strains are computed & saved\n')
                f.write('    7\n')
                f.write('{:5d}{:5d}{:5d}{:10d}\n'.format(self.soil_number[i], 1, 1, self.get_acc_length()))
                f.write('{:5d}{:5d}{:5d}{:10d}\n'.format(self.soil_number[i], 0, 1, self.get_acc_length()))

            # option9
            f.write('option 9 -- compute & save response spectrum\n')
            f.write('    9\n')
            f.write('    1    0\n')
            f.write('    1    0     981.0\n')
            f.write('   0.05\n')

            # stop
            f.write('excution will stop when program encounters 0\n')
            f.write('    0\n')



    def load_acceleration(self):
        dialog = QtWidgets.QFileDialog()
        dialog.setFileMode(QtWidgets.QFileDialog.AnyFile)
        dialog.setFilter(QtCore.QDir.Files)
        if dialog.exec():
            filenames = dialog.selectedFiles()
            self.lineEdit_acc_file.setText(filenames[0].split('/')[-1])

    def get_acc_length(self):
        with open('sh.acc', 'r') as f:
            acc_1 = np.array(f.readlines())
            acc = []
            # print(acc_1)
            for i in acc_1:
                i = i.strip()
                if len(i):
                    temp = i.split()
                    acc.extend(temp)
            acc = np.array(acc, dtype=float)
            acc_length = np.shape(acc)[0]
            return acc_length

    def get_acc_max(self):
        with open('sh.acc', 'r') as f:
            acc_1 = np.array(f.readlines())
            acc = []
            # print(acc_1)
            for i in acc_1:
                i = i.strip()
                if len(i):
                    temp = i.split()
                    acc.extend(temp)
            acc = np.array(acc, dtype=float)
            max1 = np.max(acc)
            min1 = -np.min(acc)
            maximum = max(max1, min1)
            return maximum

    def get_acc_header_lines(self):
        with open('sh.acc', 'r') as f:
            acc_1 = np.array(f.readlines())
            acc = []
            header = 0
            # print(acc_1)
            for i in acc_1:
                i = i.strip()
                if not len(i):
                    header = header + 1
            return header

    def get_acc_number_per_line(self):
        with open('sh.acc', 'r') as f:
            acc_1 = np.array(f.readlines())
            acc = []
            num_per_line = 0
            for i in acc_1:
                i = i.strip()
                if len(i):
                    i = i.split()
                    num_per_line = len(i)
                    break
        return num_per_line

    def get_option1_table_widget(self):
        rows_option1, columns_option1 = self.count_table_widget1()
        shear_strain_shear_modulus = np.zeros((columns_option1, rows_option1))
        shear_modulus_curve = np.zeros((columns_option1, rows_option1))
        shear_strain_damping = np.zeros((columns_option1, rows_option1))
        damping_curve = np.zeros((columns_option1, rows_option1))
        for i in range(columns_option1):
            for j in range(rows_option1):
                shear_strain_shear_modulus[i][j] = self.tableWidget_option1.item(j, 4 * i).text()
                shear_modulus_curve[i][j] = self.tableWidget_option1.item(j, 4 * i + 1).text()
                shear_strain_damping[i][j] = self.tableWidget_option1.item(j, 4 * i + 2).text()
                damping_curve[i][j] = self.tableWidget_option1.item(j, 4 * i + 3).text()
        return shear_strain_shear_modulus, shear_modulus_curve, shear_strain_damping, damping_curve

    def get_option2_table_widget(self):
        total_number = self.count_table_widget2()
        soil_number = np.zeros(total_number, dtype=int)
        soil_type = np.zeros(total_number, dtype=int)
        soil_thickness = np.zeros(total_number - 1, dtype=float)
        soil_initial_damping = np.zeros(total_number, dtype=float)
        soil_unit_weight = np.zeros(total_number, dtype=float)
        soil_vs_max = np.zeros(total_number, dtype=float)

        try:
            for i in range(total_number - 1):
                soil_number[i] = int(self.tableWidget_option2.item(i, 0).text())
                soil_type[i] = int(self.tableWidget_option2.item(i, 1).text())
                soil_thickness[i] = float(self.tableWidget_option2.item(i, 2).text())
                soil_initial_damping[i] = float(self.tableWidget_option2.item(i, 3).text())
                soil_unit_weight[i] = float(self.tableWidget_option2.item(i, 4).text())
                soil_vs_max[i] = float(self.tableWidget_option2.item(i, 5).text())
        except:
            QMessageBox.about(self, "错误", "检查option2输入格式")
        try:
            soil_number[total_number - 1] = int(self.tableWidget_option2.item(total_number - 1, 0).text())
            soil_type[total_number - 1] = int(self.tableWidget_option2.item(total_number - 1, 1).text())
            soil_initial_damping[total_number - 1] = float(self.tableWidget_option2.item(total_number - 1, 3).text())
            soil_unit_weight[total_number - 1] = float(self.tableWidget_option2.item(total_number - 1, 4).text())
            soil_vs_max[total_number - 1] = float(self.tableWidget_option2.item(total_number - 1, 5).text())
        except:
            QMessageBox.about(self, "错误", "检查option2最后一行输入格式")
        return soil_number, soil_type, soil_thickness * 3.2808399, \
               soil_initial_damping, soil_unit_weight / 157.087, soil_vs_max * 3.2808399

    def count_table_widget1(self):
        rows_sum = 0
        columns_sum = 0
        for i in range(20):
            try:
                if float(self.tableWidget_option1.item(i, 0).text()) is not None:
                    rows_sum = i + 1

            except:
                pass
        for i in range(52):
            try:
                if float(self.tableWidget_option1.item(0, i).text()) is not None:
                    columns_sum = (i + 1)

            except:
                pass
        if columns_sum % 4:
            QMessageBox.about(self, "错误", "option1表格列数有误")
        return rows_sum, int(columns_sum / 4)

    def count_table_widget2(self):
        rows_sum = 0
        for i in range(70):
            try:
                if float(self.tableWidget_option2.item(i, 0).text()) is not None:
                    rows_sum = i + 1
            except:
                pass
        return rows_sum

    def clear_option1(self):
        self.tableWidget_option1.clearContents()

    def clear_option2(self):
        self.tableWidget_option2.clearContents()






    # 复制粘贴基本slot函数
    def selected_cell(self, index):
        self.index_row = index.row()
        self.index_column = index.column()
        self.current_table_widget_name = self.sender().objectName()
        self.current_table_widget = self.sender()

    def selected_table(self):
        self.current_table_widget_name = self.sender().objectName()
        self.current_table_widget = self.sender()

    def keyPressEvent(self, event):
        if (event.key() == QtCore.Qt.Key_C) and QApplication.keyboardModifiers() == QtCore.Qt.ControlModifier:
            a = self.table_copy()
            self.clipboard.setText(self.STR)
            self.STR = str()
        else:
            pass
        if (event.key() == QtCore.Qt.Key_V) and QApplication.keyboardModifiers() == QtCore.Qt.ControlModifier:
            self.table_paste()
        else:
            pass

    def table_copy(self):
        self.clipboard.clear()
        selectRect = self.current_table_widget.selectedRanges()
        for r in selectRect:
            self.top = r.topRow()
            self.left = r.leftColumn()
            self.bottom = r.bottomRow()
            self.right = r.rightColumn()

        self.column_n = self.right - self.left + 1
        self.row_n = self.bottom - self.top + 1
        self.number = self.row_n * self.column_n

        for i in range(self.number):
            self.c.append(' \t')
            if (i % self.column_n) == (self.column_n- 1):
                self.c.append('\n')
            else:
                pass
        self.c.pop()

        range1 = range(self.top, self.bottom+1)
        range2 = range(self.left, self.right+1)
        for row, column in product(range1, range2):
            try:
                data = self.current_table_widget.item(row, column).text()
                number2 = (row - self.top) * (self.column_n + 1)+(column - self.left)
                self.c[number2] = data+'\t'
            except:
                pass
        self.STR = str()
        for s in self.c:
            self.STR = self.STR+s

    def table_paste(self):
        try:
            i = self.index_row
            j = self.index_column
            content = self.current_table_widget.item(i, j).text()
            b = str()
            for a in content:
                if a != '\n':
                    if a != '\t':
                        b = b + a
                    else:
                        item = QTableWidgetItem(b)
                        self.current_table_widget.setItem(i, j, item)
                        b = ''
                        j += 1
                else:
                    item = QTableWidgetItem(b)
                    self.current_table_widget.setItem(i, j, item)
                    b = ''
                    i += 1
                    j = self.index_column
                item = QTableWidgetItem(b)
                self.current_table_widget.setItem(i, j, item)
        except:
            pass


if __name__ == '__main__':
    app = QApplication(sys.argv)
    shake = Ui_Form()
    shake.show()
    sys.exit(app.exec())
